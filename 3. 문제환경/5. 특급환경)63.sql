
ALTER SESSION SET WORKAREA_SIZE_POLICY='MANUAL';
ALTER SESSION SET SORT_AREA_SIZE=1000000000;

DROP TABLE YOON.T1_63;
CREATE TABLE YOON.T1_63
  (TRD   VARCHAR2(8),
   COL1  VARCHAR2(8),
   ACNO  VARCHAR2(8),
   C11   VARCHAR2(50),
   C12   VARCHAR2(50),
   C13   VARCHAR2(50),
   C14   VARCHAR2(50),
   CONSTRAINT PK_T1_63 PRIMARY KEY(TRD, COL1, ACNO)
   USING INDEX LOCAL
   ) NOLOGGING
PARTITION BY RANGE(TRD)
   (PARTITION PT201701 VALUES LESS THAN ('20170201'),
    PARTITION PT201702 VALUES LESS THAN ('20170301'),
    PARTITION PT201703 VALUES LESS THAN ('20170401'),
    PARTITION PT201704 VALUES LESS THAN ('20170501'),
    PARTITION PT201705 VALUES LESS THAN ('20170601'),
    PARTITION PT201706 VALUES LESS THAN ('20170701'),
    PARTITION PT201707 VALUES LESS THAN ('20170801'),
    PARTITION PT201708 VALUES LESS THAN ('20170901'),
    PARTITION PT201709 VALUES LESS THAN ('20171001'),
    PARTITION PT201710 VALUES LESS THAN ('20171101'),
    PARTITION PT201711 VALUES LESS THAN ('20171201'),
    PARTITION PT201712 VALUES LESS THAN ('20180101')
    );

--CREATE PUBLIC SYNONYM T1_63   FOR  YOON.T1_63;

INSERT /*+ APPEND */ INTO YOON.T1_63
SELECT A.YYYYMM || LPAD(TO_CHAR(MOD(ROWNUM, 30)+1), 2, '0') TRD,
       B.COL1, C.ACNO, 
       'ASDFFDSAASDFFDSAASDFFDSA' C11,
       'ASDFFDSAASDFFDSAASDFFDSA' C12,
       'ASDFFDSAASDFFDSAASDFFDSA' C13,
       'ASDFFDSAASDFFDSAASDFFDSA' C14
FROM (SELECT 201713 - ROWNUM YYYYMM
      FROM DUAL
      CONNECT BY LEVEL <= 12
     ) A,
     (SELECT 'B'||LPAD(TO_CHAR(LEVEL), 7, '0') COL1
      FROM DUAL
      CONNECT BY LEVEL <=1000
     )B,
     (SELECT 'A'||LPAD(TO_CHAR(LEVEL), 7, '0') ACNO
      FROM DUAL
      CONNECT BY LEVEL <=1000
     ) C
;

COMMIT;

CREATE INDEX YOON.IX_T1_63 
ON YOON.T1_63 (ACNO, TRD)
LOCAL;


DROP TABLE YOON.T2_63;
CREATE TABLE YOON.T2_63
  (TRD   VARCHAR2(8),
   COL1  VARCHAR2(8),
   ACNO  VARCHAR2(8),
   COL2  NUMBER,
   C11   VARCHAR2(50),
   C12   VARCHAR2(50),
   C13   VARCHAR2(50),
   C14   VARCHAR2(50),
   CONSTRAINT PK_T2_63 PRIMARY KEY(TRD, COL1, ACNO, COL2) 
   USING INDEX LOCAL
   ) NOLOGGING
PARTITION BY RANGE(TRD)
   (PARTITION PT201701 VALUES LESS THAN ('20170201'),
    PARTITION PT201702 VALUES LESS THAN ('20170301'),
    PARTITION PT201703 VALUES LESS THAN ('20170401'),
    PARTITION PT201704 VALUES LESS THAN ('20170501'),
    PARTITION PT201705 VALUES LESS THAN ('20170601'),
    PARTITION PT201706 VALUES LESS THAN ('20170701'),
    PARTITION PT201707 VALUES LESS THAN ('20170801'),
    PARTITION PT201708 VALUES LESS THAN ('20170901'),
    PARTITION PT201709 VALUES LESS THAN ('20171001'),
    PARTITION PT201710 VALUES LESS THAN ('20171101'),
    PARTITION PT201711 VALUES LESS THAN ('20171201'),
    PARTITION PT201712 VALUES LESS THAN ('20180101')
    );

--CREATE PUBLIC SYNONYM T2_63   FOR  YOON.T2_63;

INSERT /*+ APPEND */ INTO YOON.T2_63
SELECT A.TRD, A.COL1, A.ACNO, B.COL2,       
       'ASDFFDSAASDFFDSAASDFFDSA' C11,
       'ASDFFDSAASDFFDSAASDFFDSA' C12,
       'ASDFFDSAASDFFDSAASDFFDSA' C13,
       'ASDFFDSAASDFFDSAASDFFDSA' C14
FROM T1_63 A, 
     (SELECT ROWNUM COL2
      FROM DUAL
      CONNECT BY LEVEL <=30
     ) B
WHERE A.TRD >= '20171001'
;

COMMIT;

DROP INDEX YOON.IX_T2_63;
CREATE INDEX YOON.IX_T2_63
ON YOON.T2_63(ACNO, TRD)
LOCAL;

EXECUTE DBMS_STATS.GATHER_TABLE_STATS('YOON', 'T1_63');
EXECUTE DBMS_STATS.GATHER_TABLE_STATS('YOON', 'T2_63');

ALTER SESSION SET WORKAREA_SIZE_POLICY='AUTO';